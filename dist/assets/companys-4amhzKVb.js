import{_ as T,o as d,m as g,a2 as $,B as M,W as z,r as t,Q as L,w as R,ag as O,ah as Q,c as W,d as c,a as B,n as h,ai as X,F as j,a8 as q,X as G,u as H,v as J}from"./index-C2tXxNt1.js";import{_ as K}from"./ContextMenu-D6kCKBdr.js";import{D as Y}from"./DeletedItem-DoTXfLXq.js";import{u as Z}from"./appState-PHT9iOR4.js";const ee={};function te(w,s){return d(),g($,{class:"text-center btn-add",density:"compact",variant:"flat",style:{"background-color":"#28a745 !important",color:"white","z-index":"10"},"prepend-icon":"ri-add-line",to:{name:"edit-company"}})}const ae=T(ee,[["render",te],["__scopeId","data-v-3838b115"]]),ne={id:"dataTable",style:{position:"relative !important","white-space":"nowrap"}},oe=["src"],se={__name:"DataTable",setup(w){const s=M(),x=z(),k=Z(),m=t(0),r=t([]),i=t(null),C=t(!1),b=t(10),V=t({nickname:"",phone:"",status:"",created_at_from:"",created_at_to:""}),_=t({page:1,sortBy:[],itemsPerPage:10}),S=t([{title:"#",key:"id",align:"center"},{title:"الشعار",key:"imageLogo",align:"center"},{title:"الاسم",key:"name",align:"center"},{title:"رقم الهاتف",key:"phone",align:"center"},{title:"المجال",key:"field",align:"center"},{title:"الوصف",key:"description",align:"center"}]);L(()=>{P()});const D=t(null),U=t(()=>{x.push({name:"edit-company",params:{id:i.value.id}}),u()}),I=t(()=>{D.value=[i.value],k.dialogDelete=!0,u()});t(()=>{u()});const v=t([]),y=t([]),A=a=>{r.value=r.value.filter(e=>!a.includes(e.id)),s.fetchUser()};R(()=>i.value,async a=>{if(!a)return;const e=await s.can(["company_update_self","company_update_own","company_update","super_admin","company_owner"]),n=await s.can(["company_delete_self","company_delete_own","company_delete","super_admin","company_owner"]);y.value=[e?{title:"تعديل",color:"#007bff",icon:"ri-pencil-line",callback:U.value}:null,n?{title:"حذف",color:"#dc3545",icon:"ri-delete-bin-line",callback:I.value}:null].filter(Boolean)},{immediate:!0}),O(()=>{y.value.length===0?v.value=[{title:"لا تملك إجراءات",color:"#6c757d",icon:"ri-spam-3-line",callback:()=>{}}]:v.value=y.value});const l=t(null),E=(a,{item:e})=>{i.value=e,a.preventDefault(),l.value&&l.value.showContextMenu(a)},u=()=>{l.value?l.value.colsContextMenu():console.error("Context menu is not initialized.")};async function P(){const{page:a,itemsPerPage:e,sortBy:n}=_.value,f=n.length?n[0].key:"id",o=n.length&&n[0].order?n[0].order:"desc",N=e===-1?m.value:e;try{const p=await Q("companys",{page:a,per_page:N,sort_by:f,sort_order:o,...V.value});r.value=p.data,m.value=p.total}catch(p){console.error("Error fetching company:",p)}finally{C.value=!1}}function F({item:a,index:e}){return{class:e%2!==0?"active-row":"","data-index":e}}return(a,e)=>{const n=Y,f=K;return d(),W(j,null,[c(n,{onUpdateItems:A,api:"company/delete",dataDelete:{items:D.value,key:"name"}},null,8,["dataDelete"]),B("div",ne,[c(X,{"item-value":"id","items-per-page":b.value,"onUpdate:itemsPerPage":e[0]||(e[0]=o=>b.value=o),options:_.value,"onUpdate:options":[e[1]||(e[1]=o=>_.value=o),P],headers:S.value,items:r.value,"items-length":m.value,loading:C.value,hover:"","show-current-page":"","row-props":F,"loading-text":" جاري تحمل البيانات ","no-data-text":" لا توجد بيانات ","items-per-page-text":"عدد الصفوف في الصفحة","onContextmenu:row":E,onClick:u},{"item.imageLogo":h(({item:o})=>[B("img",{class:"mt-2",width:"100",height:"50",src:o.logo,alt:"Avatar"},null,8,oe)]),_:1},8,["items-per-page","options","headers","items","items-length","loading"]),c(f,{ref_key:"contextMenu",ref:l,actions:v.value},null,8,["actions"])])],64)}}},ue={__name:"companys",setup(w){const s=M();return(x,k)=>(d(),g(q,{style:{position:"relative"},cols:"12"},{default:h(()=>[c(G,{class:"pa-0",title:" الشركات "},{default:h(()=>[c(se)]),_:1}),H(s).can(["companys_create","super_admin","company_owner"])?(d(),g(ae,{key:0})):J("",!0)]),_:1}))}};export{ue as default};
