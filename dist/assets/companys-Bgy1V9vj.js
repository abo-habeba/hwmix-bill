import{_ as T,o as d,l as y,a9 as $,A as M,h as z,r as t,Q as L,w as R,ao as q,ap as O,c as Q,d as c,a as B,k as h,aq as W,F as j,a5 as G,W as H,u as J,s as K}from"./index-eQY_ApO-.js";import{_ as X}from"./ContextMenu-B9WKuZvC.js";import{D as Y}from"./DeletedItem-CcZcIkqD.js";import{u as Z}from"./appState-BZBK1uBF.js";const ee={};function te(k,s){return d(),y($,{class:"text-center btn-add",density:"compact",variant:"flat",style:{"background-color":"#28a745 !important",color:"white","z-index":"10"},"prepend-icon":"ri-add-line",to:{name:"edit-company"}})}const ae=T(ee,[["render",te],["__scopeId","data-v-3838b115"]]),ne={id:"dataTable",style:{position:"relative !important","white-space":"nowrap"}},oe=["src"],se={__name:"CompanysDataTable",setup(k){const s=M(),x=z(),w=Z(),m=t(0),r=t([]),i=t(null),C=t(!1),b=t(10),V=t({nickname:"",phone:"",status:"",created_at_from:"",created_at_to:""}),_=t({page:1,sortBy:[],itemsPerPage:10}),S=t([{title:"#",key:"id",align:"center"},{title:"الشعار",key:"imageLogo",align:"center"},{title:"الاسم",key:"name",align:"center"},{title:"رقم الهاتف",key:"phone",align:"center"},{title:"المجال",key:"field",align:"center"},{title:"الوصف",key:"description",align:"center"}]);L(()=>{P()});const D=t(null),U=t(()=>{x.push({name:"edit-company",params:{id:i.value.id}}),p()}),A=t(()=>{D.value=[i.value],w.dialogDelete=!0,p()});t(()=>{p()});const v=t([]),f=t([]),I=a=>{r.value=r.value.filter(e=>!a.includes(e.id)),s.fetchUser()};R(()=>i.value,async a=>{if(!a)return;const e=await s.can(["companies.update_all","companies.update_children","companies.update_self","companies.create","admin.super","admin.company"]),n=await s.can(["companies.delete_all","companies.delete_children","companies.delete_self","admin.super","admin.company"]);f.value=[e?{title:"تعديل",color:"#007bff",icon:"ri-pencil-line",callback:U.value}:null,n?{title:"حذف",color:"#dc3545",icon:"ri-delete-bin-line",callback:A.value}:null].filter(Boolean)},{immediate:!0}),q(()=>{f.value.length===0?v.value=[{title:"لا تملك إجراءات",color:"#6c757d",icon:"ri-spam-3-line",callback:()=>{}}]:v.value=f.value});const l=t(null),E=(a,{item:e})=>{i.value=e,a.preventDefault(),l.value&&l.value.showContextMenu(a)},p=()=>{l.value?l.value.colsContextMenu():console.error("Context menu is not initialized.")};async function P(){const{page:a,itemsPerPage:e,sortBy:n}=_.value,g=n.length?n[0].key:"id",o=n.length&&n[0].order?n[0].order:"desc",N=e===-1?m.value:e;try{const u=await O("companys",{page:a,per_page:N,sort_by:g,sort_order:o,...V.value});r.value=u.data,m.value=u.total}catch(u){console.error("Error fetching company:",u)}finally{C.value=!1}}function F({item:a,index:e}){return{class:e%2!==0?"active-row":"","data-index":e}}return(a,e)=>{const n=Y,g=X;return d(),Q(j,null,[c(n,{onUpdateItems:I,api:"company/delete",dataDelete:{items:D.value,key:"name"}},null,8,["dataDelete"]),B("div",ne,[c(W,{"item-value":"id","items-per-page":b.value,"onUpdate:itemsPerPage":e[0]||(e[0]=o=>b.value=o),options:_.value,"onUpdate:options":[e[1]||(e[1]=o=>_.value=o),P],headers:S.value,items:r.value,"items-length":m.value,loading:C.value,hover:"","show-current-page":"","row-props":F,"loading-text":" جاري تحمل البيانات ","no-data-text":" لا توجد بيانات ","items-per-page-text":"عدد الصفوف في الصفحة","onContextmenu:row":E,onClick:p},{"item.imageLogo":h(({item:o})=>[B("img",{class:"mt-2",width:"100",height:"50",src:o.logo,alt:"Avatar"},null,8,oe)]),_:1},8,["items-per-page","options","headers","items","items-length","loading"]),c(g,{ref_key:"contextMenu",ref:l,actions:v.value},null,8,["actions"])])],64)}}},pe={__name:"companys",setup(k){const s=M();return(x,w)=>(d(),y(G,{style:{position:"relative"},cols:"12"},{default:h(()=>[c(H,{class:"pa-0",title:" الشركات "},{default:h(()=>[c(se)]),_:1}),J(s).can(["companies.create","admin.super","admin.company"])?(d(),y(ae,{key:0})):K("",!0)]),_:1}))}};export{pe as default};
