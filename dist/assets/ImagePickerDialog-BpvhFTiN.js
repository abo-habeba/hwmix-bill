import{_ as z,r as u,P as I,w as U,ap as $,o as d,c as y,d as a,j as s,a9 as f,b as m,t as M,a5 as _,U as B,ah as q,a as o,aB as E,M as S,a1 as L,k as x,aC as O,a4 as X,F as D,A as Z,p as G,D as H,a8 as J,au as K,X as Q,at as W,Z as Y}from"./index-fbBcwaLu.js";const ee={class:"d-flex justify-end pa-1"},le={key:2,class:"d-flex flex-column justify-center align-center text-center text-grey-darken-1 flex-grow-1"},ae={__name:"ImagePickerDialog",props:{modelValue:Boolean,buttonText:{type:String,default:"اختيار صورة"},multiple:{type:Boolean,default:!1}},emits:["update:modelValue","close"],setup(k,{emit:j}){const v=k,V=j,c=u(!1),r=u([]),t=u([]),i=u([]),g=u(!1),p=u(!1),b=u(null);I(()=>{C()}),U(()=>v.modelValue,e=>{c.value=e,e&&(C(),t.value=[])});const w=()=>{V("update:modelValue",!1),c.value=!1,i.value=[]},A=()=>{const e=v.multiple?t.value:t.value[0];V("close",[e]),w()},C=async()=>{g.value=!0;try{const e=await $("images",{is_temp:1});r.value=e}catch(e){console.error("خطأ في تحميل الصور:",e)}finally{g.value=!1}},T=async()=>{if(t.value.length)try{await W("images/delete",{ids:t.value}),r.value=r.value.filter(e=>!t.value.includes(e.id)),t.value=[]}catch(e){console.error("خطأ في حذف الصور:",e)}},F=()=>{b.value.$el.querySelector('input[type="file"]').click()},N=()=>{i.value&&i.value.length>0&&P()},P=async()=>{if(i.value.length){p.value=!0;try{const e=await Y("image",{images:i.value});e&&Array.isArray(e)?r.value.unshift(...e):e&&r.value.unshift(e),i.value=[]}catch(e){console.error("خطأ في رفع الصور:",e)}finally{p.value=!1}}},h=e=>t.value.includes(e),R=e=>{if(v.multiple){const l=t.value.indexOf(e);l>-1?t.value.splice(l,1):t.value.push(e)}else t.value=t.value[0]===e?[]:[e]};return I(()=>{}),(e,l)=>(d(),y(D,null,[a(_,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:s(()=>[a(f,{onClick:l[0]||(l[0]=n=>c.value=!0)},{default:s(()=>[m(M(k.buttonText),1)]),_:1})]),_:1}),a(Q,{modelValue:c.value,"onUpdate:modelValue":l[2]||(l[2]=n=>c.value=n),"max-width":"900",scrollable:"",persistent:""},{default:s(()=>[a(B,{rounded:"lg"},{default:s(()=>[a(q,{class:"d-flex justify-space-between align-center py-4 px-6 bg-blue-grey-lighten-5"},{default:s(()=>[l[4]||(l[4]=o("span",{class:"text-h6 font-weight-bold text-blue-grey-darken-3"},"مكتبة الصور",-1)),a(f,{color:"blue-grey-darken-2",variant:"flat",rounded:"pill",size:"small",class:"text-caption font-weight-bold",onClick:F,loading:p.value,disabled:p.value},{default:s(()=>l[3]||(l[3]=[o("i",{class:"ri-add-line mr-1"},null,-1),m(" إضافة صور من الجهاز ")])),_:1},8,["loading","disabled"]),a(E,{ref_key:"fileInputRef",ref:b,modelValue:i.value,"onUpdate:modelValue":l[1]||(l[1]=n=>i.value=n),multiple:"",accept:"image/*",class:"d-none",onChange:N},null,8,["modelValue"])]),_:1}),a(S),a(L,{class:"pa-4 image-grid-container"},{default:s(()=>[g.value?(d(),x(O,{key:0,indeterminate:"",color:"primary",class:"d-flex justify-center align-center w-100",size:"64",width:"6"})):r.value.length>0?(d(),x(X,{key:1,dense:""},{default:s(()=>[(d(!0),y(D,null,Z(r.value,n=>(d(),x(_,{key:n.id,cols:"6",sm:"4",md:"3",lg:"2",class:"pa-"},{default:s(()=>[a(B,{outlined:"",class:G(["image-card d-flex flex-column",{"selected-card":h(n.id)}]),onClick:te=>R(n.id),rounded:"md",elevation:"2"},{default:s(()=>[a(H,{src:n.url,height:"100",cover:"",class:"rounded-t-md"},null,8,["src"]),o("div",ee,[a(J,{"model-value":h(n.id),"hide-details":"",density:"compact",class:"ma-0 pa-0",color:"primary"},null,8,["model-value"])])]),_:2},1032,["class","onClick"])]),_:2},1024))),128))]),_:1})):(d(),y("div",le,l[5]||(l[5]=[o("i",{class:"ri-image-line text-h1 mb-4"},null,-1),o("p",{class:"text-h6 font-weight-medium"},"لا توجد صور لعرضها بعد.",-1),o("p",{class:"text-body-2"},"يمكنك البدء بإضافة صور جديدة إلى مكتبتك.",-1)])))]),_:1}),a(S),a(K,{class:"d-flex justify-end py-3 px-6 sticky-actions"},{default:s(()=>[a(f,{color:"red-darken-1",variant:"flat",rounded:"pill",onClick:T,disabled:!t.value.length,class:"mr-2"},{default:s(()=>l[6]||(l[6]=[o("i",{class:"ri-delete-bin-line mr-1"},null,-1),m(" حذف ")])),_:1},8,["disabled"]),a(f,{color:"primary",variant:"flat",rounded:"pill",onClick:A,disabled:!t.value.length,class:"mr-2"},{default:s(()=>l[7]||(l[7]=[o("i",{class:"ri-check-line mr-1"},null,-1),m(" تعيين ")])),_:1},8,["disabled"]),a(f,{color:"grey-darken-1",variant:"outlined",rounded:"pill",onClick:w},{default:s(()=>l[8]||(l[8]=[o("i",{class:"ri-close-line mr-1"},null,-1),m(" إلغاء ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},ne=z(ae,[["__scopeId","data-v-a679bebe"]]);export{ne as I};
