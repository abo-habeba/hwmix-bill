import{aK as N,aL as ae,aM as re,aN as R,r as y,j as T,aO as O,aP as j,d as l,F,aQ as oe,n as A,aR as ce,aS as de,aT as ve,aU as fe,aV as me,aW as ge,I as W,x as he,aX as pe,aY as Ve,J as q,a9 as P,aZ as z,L as be,M as we,a_ as Ie,a$ as Ce,a3 as E,b0 as ke,b1 as xe,b2 as ye,b3 as k,b4 as Q,b5 as Te,b6 as Pe,b7 as Se,H as Y,Q as _e,l as Z,k as C,aC as Le,ap as Ae,o as H,b as D,ai as J,N as De,a as Ge,u as $e,s as Be,W as X,t as ee,a1 as Ee,a6 as Fe,b8 as Me,au as Ne,Z as Re,Y as Oe,aa as G,$ as Ue,aB as Ke}from"./index-Bx5AtKRY.js";const je=N({...ae(re({collapseIcon:"$treeviewCollapse",expandIcon:"$treeviewExpand"}),["subgroup"])},"VTreeviewGroup"),te=R()({name:"VTreeviewGroup",props:je(),setup(e,b){let{slots:v}=b;const t=y(),r=T(()=>{var m;return(m=t.value)!=null&&m.isOpen?e.collapseIcon:e.expandIcon}),h=T(()=>{var m;return{VTreeviewItem:{prependIcon:void 0,appendIcon:void 0,active:(m=t.value)==null?void 0:m.isOpen,toggleIcon:r.value}}});return O(()=>{const m=j.filterProps(e);return l(j,A(m,{ref:t,class:["v-treeview-group",e.class],subgroup:!0}),{...v,activator:v.activator?o=>l(F,null,[l(oe,{defaults:h.value},{default:()=>{var f;return[(f=v.activator)==null?void 0:f.call(v,o)]}})]):void 0})}),{}}}),ne=Symbol.for("vuetify:v-treeview"),We=N({loading:Boolean,toggleIcon:ce,...de({slim:!0})},"VTreeviewItem"),le=R()({name:"VTreeviewItem",props:We(),setup(e,b){let{attrs:v,slots:t,emit:r}=b;const h=ve(e,v),m=T(()=>e.value===void 0?h.href.value:e.value),o=y(),{activate:f,isActivated:p,select:w,isSelected:g,isIndeterminate:I,isGroupActivator:x,root:a,id:i}=fe(m,!1),c=T(()=>a.activatable.value&&x),{densityClasses:d}=me(e,"v-list-item"),s=T(()=>({isActive:p.value,select:w,isSelected:g.value,isIndeterminate:I.value})),n=T(()=>{var V;return!e.disabled&&e.link!==!1&&(e.link||h.isClickable.value||e.value!=null&&!!((V=o.value)!=null&&V.list))});function u(V){var $,B;!n.value||!c.value&&x||a.activatable.value&&(c.value?f(!p.value,V):(B=o.value)==null||B.activate(!(($=o.value)!=null&&$.isActivated),V))}function S(V){(V.key==="Enter"||V.key===" ")&&(V.preventDefault(),u(V))}const _=ge(ne,{visibleIds:y()}).visibleIds;return O(()=>{var U;const V=t.title||e.title!=null,$=t.subtitle||e.subtitle!=null,B=W.filterProps(e),ue=t.prepend||e.toggleIcon;return c.value?he(l("div",{class:["v-list-item","v-list-item--one-line","v-treeview-item","v-treeview-item--activetable-group-activator",{"v-list-item--active":p.value||g.value,"v-treeview-item--filtered":_.value&&!_.value.has(i.value)},d.value,e.class],onClick:u},[l(F,null,[Ve(p.value||g.value,"v-list-item"),e.toggleIcon&&l(q,{start:!1},{default:()=>[l(P,{density:"compact",icon:e.toggleIcon,loading:e.loading,variant:"text",onClick:e.onClick},{loader(){return l(z,{indeterminate:"disable-shrink",size:"20",width:"2"},null)}})]})]),l("div",{class:"v-list-item__content","data-no-activator":""},[V&&l(be,{key:"title"},{default:()=>{var L;return[((L=t.title)==null?void 0:L.call(t,{title:e.title}))??e.title]}}),$&&l(we,{key:"subtitle"},{default:()=>{var L;return[((L=t.subtitle)==null?void 0:L.call(t,{subtitle:e.subtitle}))??e.subtitle]}}),(U=t.default)==null?void 0:U.call(t,s.value)])]),[[pe("ripple"),n.value&&e.ripple]]):l(W,A({ref:o},B,{class:["v-treeview-item",{"v-treeview-item--filtered":_.value&&!_.value.has(i.value)},e.class],value:i.value,onClick:u,onKeydown:n.value&&S}),{...t,prepend:ue?L=>{var K;return l(F,null,[e.toggleIcon&&l(q,{start:!1},{default:()=>[l(P,{density:"compact",icon:e.toggleIcon,loading:e.loading,variant:"text"},{loader(){return l(z,{indeterminate:"disable-shrink",size:"20",width:"2"},null)}})]}),(K=t.prepend)==null?void 0:K.call(t,L)])}:void 0})}),{}}}),ie=N({loadChildren:Function,loadingIcon:{type:String,default:"$loading"},items:Array,selectable:Boolean,selectStrategy:[String,Function,Object]},"VTreeviewChildren"),M=R()({name:"VTreeviewChildren",props:ie(),setup(e,b){let{emit:v,slots:t}=b;const r=Ie(null);function h(o){return new Promise(f=>{var p,w;if(!((p=e.items)!=null&&p.length)||!e.loadChildren)return f();if(((w=o==null?void 0:o.children)==null?void 0:w.length)===0){r.value=o.value,e.loadChildren(o).then(f);return}f()}).finally(()=>{r.value=null})}function m(o,f){e.selectable&&o(!f)}return()=>{var o,f;return((o=t.default)==null?void 0:o.call(t))??((f=e.items)==null?void 0:f.map(p=>{var d;let{children:w,props:g,raw:I}=p;const x=r.value===I.value,a={prepend:s=>{var n;return l(F,null,[e.selectable&&(!w||w&&!["leaf","single-leaf"].includes(e.selectStrategy))&&l("div",null,[l(Ce,{key:I.value,modelValue:s.isSelected,loading:x,indeterminate:s.isIndeterminate,onClick:E(()=>m(s.select,s.isSelected),["stop"]),onKeydown:u=>{["Enter","Space"].includes(u.key)&&(u.stopPropagation(),m(s.select,s.isSelected))}},null)]),(n=t.prepend)==null?void 0:n.call(t,{...s,item:I})])},append:t.append?s=>{var n;return(n=t.append)==null?void 0:n.call(t,{...s,item:I})}:void 0,title:t.title?s=>{var n;return(n=t.title)==null?void 0:n.call(t,{...s,item:I})}:void 0},i=te.filterProps(g),c=M.filterProps(e);return w?l(te,A({value:g==null?void 0:g.value},i),{activator:s=>{let{props:n}=s;const u={...g,...n,value:g==null?void 0:g.value};return l(le,A(u,{loading:x,onClick:()=>h(I)}),a)},default:()=>l(M,A(c,{items:w}),t)}):((d=t.item)==null?void 0:d.call(t,{props:g}))??l(le,g,a)}))}}});function se(e){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];for(const v of e)b.push(v),v.children&&se(v.children,b);return b}const qe=N({openAll:Boolean,search:String,...ke({filterKeys:["title"]}),...ie(),...ae(xe({collapseIcon:"$treeviewCollapse",expandIcon:"$treeviewExpand",slim:!0}),["nav"])},"VTreeview"),ze=R()({name:"VTreeview",props:qe(),emits:{"update:opened":e=>!0,"update:activated":e=>!0,"update:selected":e=>!0,"click:open":e=>!0,"click:select":e=>!0},setup(e,b){let{slots:v}=b;const{items:t}=ye(e),r=k(e,"activeColor"),h=k(e,"baseColor"),m=k(e,"color"),o=Q(e,"activated"),f=Q(e,"selected"),p=y(),w=T(()=>e.openAll?d(t.value):e.opened),g=T(()=>se(t.value)),I=k(e,"search"),{filteredItems:x}=Te(e,g,I),a=T(()=>I.value?new Set(x.value.flatMap(s=>[...i(s.props.value),...c(s.props.value)])):null);function i(s){var S;const n=[];let u=s;for(;u!=null;)n.unshift(u),u=(S=p.value)==null?void 0:S.parents.get(u);return n}function c(s){var S,_;const n=[],u=(((S=p.value)==null?void 0:S.children.get(s))??[]).slice();for(;u.length;){const V=u.shift();V&&(n.push(V),u.push(...(((_=p.value)==null?void 0:_.children.get(V))??[]).slice()))}return n}function d(s){let n=[];for(const u of s)u.children&&(n.push(u.value),u.children&&(n=n.concat(d(u.children))));return n}return Pe(ne,{visibleIds:a}),Se({VTreeviewGroup:{activeColor:r,baseColor:h,color:m,collapseIcon:k(e,"collapseIcon"),expandIcon:k(e,"expandIcon")},VTreeviewItem:{activeClass:k(e,"activeClass"),activeColor:r,baseColor:h,color:m,density:k(e,"density"),disabled:k(e,"disabled"),lines:k(e,"lines"),variant:k(e,"variant")}}),O(()=>{const s=Y.filterProps(e),n=M.filterProps(e);return l(Y,A({ref:p},s,{class:["v-treeview",e.class],style:e.style,opened:w.value,activated:o.value,"onUpdate:activated":u=>o.value=u,selected:f.value,"onUpdate:selected":u=>f.value=u}),{default:()=>[l(M,A(n,{items:t.value}),v)]})}),{open}}}),Qe={style:{width:"max-content"}},Ze={__name:"Categories",setup(e){const b=y([]),v=y([]),t=y(!1),r=y({name:"",description:"",parent_id:null}),h=y(!1);function m(a){h.value=!1,a?r.value.parent_id=a.id:r.value.parent_id=null,r.value.name="",r.value.description="",t.value=!0}function o(a){h.value=!0,r.value={...a},t.value=!0}function f(){t.value=!1,h.value=!1,r.value={name:"",description:"",parent_id:null}}function p(a){const i={};a.forEach(d=>{d.children=d.children||[],i[d.id]=d});const c=[];return a.forEach(d=>{d.parent_id?i[d.parent_id]&&i[d.parent_id].children.push(d):c.push(d)}),c}function w(){Ae("categories").then(a=>{b.value=a.data,console.log(b.value),v.value=p(b.value),console.log(v.value)})}const g=a=>({expandIcon:a.children&&a.children.length?"ri-folder-line":"ri-checkbox-blank-circle-line",collapseIcon:a.children&&a.children.length?"ri-folder-open-line":"ri-checkbox-blank-circle-line"});_e(()=>{w()});function I(){if(!r.value.name){G.error("اسم الفئة مطلوب");return}const a=h.value&&r.value.id;Ue("category",r.value,a?r.value.id:!1,!0,!0).then(()=>{w(),f(),G.success(a?"تم تعديل الفئة بنجاح":"تم حفظ الفئة بنجاح")}).catch(()=>G.error(a?"حدث خطأ أثناء تعديل الفئة":"حدث خطأ أثناء حفظ الفئة"))}function x(a){confirm("هل أنت متأكد من حذف هذه الفئة؟")&&Ke("category",a).then(()=>{w(),G.success("تم حذف الفئة بنجاح")}).catch(()=>G.error("حدث خطأ أثناء حذف الفئة"))}return(a,i)=>(H(),Z(Le,null,{default:C(()=>[l(P,{color:"primary",class:"mb-4",onClick:i[0]||(i[0]=c=>m(null))},{default:C(()=>i[4]||(i[4]=[D("اضافة فئة رئيسية جديدة")])),_:1}),l(X,{class:"mt-4 pa-3",outlined:"",style:{"overflow-x":"auto"}},{default:C(()=>[l(J,null,{default:C(()=>i[5]||(i[5]=[D("الفئات الهرمية")])),_:1}),l(De),Ge("div",Qe,[v.value.length?(H(),Z($e(ze),{key:0,items:v.value,"item-title":"name","item-value":"id","open-on-click":"","item-props":g,class:"treeview-border ma-auto","max-width":"unset"},{append:C(({item:c})=>[l(P,{icon:"ri-add-line",variant:"text",color:"primary",onClick:E(d=>m(c),["stop"]),title:"إضافة فرعية",class:"mx-1"},null,8,["onClick"]),l(P,{icon:"ri-edit-line",variant:"text",color:"primary",onClick:E(d=>o(c),["stop"]),title:"تعديل الفئة",class:"mx-1"},null,8,["onClick"]),l(P,{icon:"ri-delete-bin-line",variant:"text",color:"error",onClick:E(d=>x(c.id),["stop"]),title:"حذف الفئة",class:"mx-1"},null,8,["onClick"])]),_:1},8,["items"])):Be("",!0)])]),_:1}),l(Oe,{modelValue:t.value,"onUpdate:modelValue":i[3]||(i[3]=c=>t.value=c),"max-width":"500px"},{default:C(()=>[l(X,null,{default:C(()=>[l(J,null,{default:C(()=>[D(ee(h.value?"تعديل فئة":"اضافة فئة جديدة"),1)]),_:1}),l(Ee,null,{default:C(()=>[l(Fe,{class:"pa-2",modelValue:r.value.name,"onUpdate:modelValue":i[1]||(i[1]=c=>r.value.name=c),label:"اسم الفئة",required:""},null,8,["modelValue"]),l(Me,{class:"pa-2",modelValue:r.value.description,"onUpdate:modelValue":i[2]||(i[2]=c=>r.value.description=c),label:"الوصف"},null,8,["modelValue"])]),_:1}),l(Ne,null,{default:C(()=>[l(Re),l(P,{text:"",onClick:f},{default:C(()=>i[6]||(i[6]=[D("الغاء")])),_:1}),l(P,{text:"",color:"blue darken-1",onClick:I},{default:C(()=>[D(ee(h.value?"تعديل":"حفظ"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Ze as default};
