import{_ as x,r,Q as D,ap as C,o as v,c as I,d as l,k as t,a9 as p,b as d,a4 as S,a5 as T,u as w,ak as F,W as y,ai as U,a1 as B,a2 as N,a6 as V,ay as q,au as O,Z as P,Y as A,F as M,l as $}from"./index-CjjdYkdB.js";const E={__name:"InstallmentsDataTable",setup(_){const i=r([]),s=r(!1),o=r(!1),m=r(null),u=r({amount:"",paid_at:new Date().toISOString().substr(0,10),payment_method:null}),b=["نقدي","تحويل بنكي","بطاقة ائتمان","شبكة الدفع الإلكتروني"];let k=[{title:"ID",key:"id"},{title:"installment_number",key:"رقم"},{title:"قيمة القسط",key:"amount"},{title:"الحالة",key:"status"},{title:"المتبقي",key:"remaining"},{title:"تاريخ الاستحقاق",key:"due_date"},{title:"الإجراءات",key:"actions",sortable:!1}];D(()=>{C("installments",null,!0,!0).then(n=>{i.value=n.data})});function c(n){m.value=n,u.value.amount=n.remaining,u.value.paid_at=new Date().toISOString().substr(0,10),u.value.payment_method=null,s.value=!0}function f(){s.value=!1,m.value=null,u.value={amount:"",paid_at:new Date().toISOString().substr(0,10),payment_method:null},o.value=!1}async function g(){if(o.value){if(Number(u.value.amount)>Number(m.value.remaining)){alert("مبلغ السداد لا يمكن أن يكون أكبر من المتبقي");return}try{alert("جاري العمل علي سداد القسط "),f()}catch(n){alert("حدث خطأ أثناء عملية الدفع"),console.error(n)}}}return(n,e)=>(v(),I(M,null,[l(F,{headers:w(k),items:i.value||[],"item-key":"id",class:"elevation-1","hide-default-footer":"",density:"compact"},{"item.actions":t(({item:a})=>[l(p,{color:"primary",small:"",onClick:R=>c(a)},{default:t(()=>e[5]||(e[5]=[d("دفع القسط")])),_:2},1032,["onClick"])]),"no-data":t(()=>[l(S,{class:"pa-4"},{default:t(()=>[l(T,{class:"text-center text-grey"},{default:t(()=>e[6]||(e[6]=[d("لا توجد بيانات مستخدمين")])),_:1})]),_:1})]),_:1},8,["headers","items"]),l(A,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=a=>s.value=a),"max-width":"400px"},{default:t(()=>[l(y,null,{default:t(()=>[l(U,null,{default:t(()=>e[7]||(e[7]=[d("سداد القسط")])),_:1}),l(B,null,{default:t(()=>[l(N,{ref:"payForm",modelValue:o.value,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value=a)},{default:t(()=>[l(V,{label:"مبلغ السداد",modelValue:u.value.amount,"onUpdate:modelValue":e[0]||(e[0]=a=>u.value.amount=a),type:"number",rules:[a=>!!a||"المبلغ مطلوب",a=>a>0||"المبلغ يجب أن يكون أكبر من صفر"],required:""},null,8,["modelValue","rules"]),l(V,{label:"تاريخ السداد",modelValue:u.value.paid_at,"onUpdate:modelValue":e[1]||(e[1]=a=>u.value.paid_at=a),type:"date",rules:[a=>!!a||"التاريخ مطلوب"],required:""},null,8,["modelValue","rules"]),l(q,{label:"طريقة الدفع",modelValue:u.value.payment_method,"onUpdate:modelValue":e[2]||(e[2]=a=>u.value.payment_method=a),items:b,rules:[a=>!!a||"اختر طريقة الدفع"],required:""},null,8,["modelValue","rules"])]),_:1},8,["modelValue"])]),_:1}),l(O,null,{default:t(()=>[l(P),l(p,{text:"",onClick:f},{default:t(()=>e[8]||(e[8]=[d("إلغاء")])),_:1}),l(p,{color:"primary",disabled:!o.value,onClick:g},{default:t(()=>e[9]||(e[9]=[d("دفع القسط")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},Q=x(E,[["__scopeId","data-v-47fb34bb"]]),Y={__name:"installments",setup(_){return(i,s)=>(v(),$(y,{class:"pa-0",title:"الاقساط"},{default:t(()=>[l(Q)]),_:1}))}};export{Y as default};
