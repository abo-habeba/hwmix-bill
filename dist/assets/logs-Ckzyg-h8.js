import{_ as B}from"./ContextMenu-CyWiCRoV.js";import{r as t,Q as V,ao as A,ap as D,o as h,c as E,d as i,aq as T,l as L,k as f,a5 as U,W as $}from"./index-m3K6ebDh.js";const q={id:"dataTable",style:{position:"relative !important","white-space":"nowrap"}},z={__name:"LogsDataTable",setup(y){t([]);const s=t(0),c=t([]),d=t(null),v=t(!1),_=t(10),k=t({nickname:"",phone:"",status:"",created_at_from:"",created_at_to:""}),u=t({page:1,sortBy:[],itemsPerPage:10}),x=t([{title:"#",key:"id",align:"center"},{title:"الحدث",key:"description",align:"center"},{title:"الاجراء",key:"action",align:"center"},{title:"المتصفح",key:"user_agent",align:"center"},{title:"تاريخ الانشاء",key:"created_at",align:"center"},{title:"ip",key:"ip_address",align:"center"},{title:"الرابط",key:"url",align:"center"}]);V(()=>{m()});const p=t([]),g=t([]);A(()=>{g.value.length===0?p.value=[{title:"لا تملك إجراءات",color:"#6c757d",icon:"ri-spam-3-line",callback:()=>{}}]:p.value=g.value});const n=t(null),w=(o,{item:e})=>{d.value=e,console.log("log.value",d.value),console.log("availableActions.value",g.value),o.preventDefault(),n.value&&n.value.showContextMenu(o)},C=()=>{n.value?n.value.colsContextMenu():console.error("Context menu is not initialized.")};async function m(){const{page:o,itemsPerPage:e,sortBy:a}=u.value,l=a.length?a[0].key:"id",M=a.length&&a[0].order?a[0].order:"desc",b=e===-1?s.value:e;try{const r=await D("logs",{page:o,per_page:b,sort_by:l,sort_order:M,...k.value});c.value=r.data,s.value=r.total}catch(r){console.error("Error fetching logs:",r)}finally{v.value=!1}}function P({item:o,index:e}){return{class:e%2!==0?"active-row":"","data-index":e}}return(o,e)=>{const a=B;return h(),E("div",q,[i(T,{"item-value":"id","items-per-page":_.value,"onUpdate:itemsPerPage":e[0]||(e[0]=l=>_.value=l),options:u.value,"onUpdate:options":[e[1]||(e[1]=l=>u.value=l),m],headers:x.value,items:c.value,"items-length":s.value,loading:v.value,hover:"","show-current-page":"","row-props":P,"loading-text":" جاري تحمل البيانات ","no-data-text":" لا توجد بيانات ","items-per-page-text":"عدد الصفوف في الصفحة","onContextmenu:row":w,onClick:C},null,8,["items-per-page","options","headers","items","items-length","loading"]),i(a,{ref_key:"contextMenu",ref:n,actions:p.value},null,8,["actions"])])}}},O={__name:"logs",setup(y){return(s,c)=>(h(),L(U,{style:{position:"relative"},cols:"12"},{default:f(()=>[i($,{class:"pa-0",title:"سجل النظام"},{default:f(()=>[i(z)]),_:1})]),_:1}))}};export{O as default};
