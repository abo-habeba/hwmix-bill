import{_ as N,o as d,k as y,a9 as T,z as B,g as $,r as t,P as j,w as L,ah as R,c as q,d as c,a as P,j as h,ai as O,F as G,aj as H,a5 as J,U as K,u as Q,q as W}from"./index-DznZkae2.js";import{_ as X}from"./ContextMenu-_50b6gW-.js";import{u as Y,D as Z}from"./DeletedItem-D0g4G75S.js";const ee={};function te(k,s){return d(),y(T,{class:"text-center btn-add",density:"compact",variant:"flat",style:{"background-color":"#28a745 !important",color:"white","z-index":"10"},"prepend-icon":"ri-add-line",to:{name:"edit-company"}})}const ae=N(ee,[["render",te],["__scopeId","data-v-3838b115"]]),ne={id:"dataTable",style:{position:"relative !important","white-space":"nowrap"}},oe=["src"],se={__name:"CompanysDataTable",setup(k){const s=B(),x=$(),w=Y(),m=t(0),r=t([]),i=t(null),C=t(!1),b=t(10),M=t({nickname:"",phone:"",status:"",created_at_from:"",created_at_to:""}),_=t({page:1,sortBy:[],itemsPerPage:10}),U=t([{title:"#",key:"id",align:"center"},{title:"الشعار",key:"imageLogo",align:"center"},{title:"الاسم",key:"name",align:"center"},{title:"رقم الهاتف",key:"phone",align:"center"},{title:"المجال",key:"field",align:"center"},{title:"الوصف",key:"description",align:"center"}]);j(()=>{});const D=t(null),V=t(()=>{x.push({name:"edit-company",params:{id:i.value.id}}),u()}),S=t(()=>{D.value=[i.value],w.dialogDelete=!0,u()});t(()=>{u()});const v=t([]),f=t([]),I=a=>{r.value=r.value.filter(e=>!a.includes(e.id)),s.fetchUser()};L(()=>i.value,async a=>{if(!a)return;const e=await s.can(["companies.update_all","companies.update_children","companies.update_self","companies.create","admin.super","admin.company"]),n=await s.can(["companies.delete_all","companies.delete_children","companies.delete_self","admin.super","admin.company"]);f.value=[e?{title:"تعديل",color:"#007bff",icon:"ri-pencil-line",callback:V.value}:null,n?{title:"حذف",color:"#dc3545",icon:"ri-delete-bin-line",callback:S.value}:null].filter(Boolean)},{immediate:!0}),R(()=>{f.value.length===0?v.value=[{title:"لا تملك إجراءات",color:"#6c757d",icon:"ri-spam-3-line",callback:()=>{}}]:v.value=f.value});const l=t(null),A=(a,{item:e})=>{i.value=e,a.preventDefault(),l.value&&l.value.showContextMenu(a)},u=()=>{l.value?l.value.colsContextMenu():console.error("Context menu is not initialized.")};async function z(){const{page:a,itemsPerPage:e,sortBy:n}=_.value,g=n.length?n[0].key:"id",o=n.length&&n[0].order?n[0].order:"desc",F=e===-1?m.value:e;try{const p=await H("companys",{page:a,per_page:F,sort_by:g,sort_order:o,...M.value});r.value=p.data,m.value=p.total}catch(p){console.error("Error fetching company:",p)}finally{C.value=!1}}function E({item:a,index:e}){return{class:e%2!==0?"active-row":"","data-index":e}}return(a,e)=>{const n=Z,g=X;return d(),q(G,null,[c(n,{onUpdateItems:I,api:"company/delete",dataDelete:{items:D.value,key:"name"}},null,8,["dataDelete"]),P("div",ne,[c(O,{"item-value":"id","items-per-page":b.value,"onUpdate:itemsPerPage":e[0]||(e[0]=o=>b.value=o),options:_.value,"onUpdate:options":[e[1]||(e[1]=o=>_.value=o),z],headers:U.value,items:r.value,"items-length":m.value,loading:C.value,hover:"","show-current-page":"","row-props":E,"loading-text":" جاري تحمل البيانات ","no-data-text":" لا توجد بيانات ","items-per-page-text":"عدد الصفوف في الصفحة","onContextmenu:row":A,onClick:u},{"item.imageLogo":h(({item:o})=>[P("img",{class:"mt-2",width:"100",height:"50",src:o.logo,alt:"Avatar"},null,8,oe)]),_:1},8,["items-per-page","options","headers","items","items-length","loading"]),c(g,{ref_key:"contextMenu",ref:l,actions:v.value},null,8,["actions"])])],64)}}},ie={__name:"companys",setup(k){const s=B();return(x,w)=>(d(),y(J,{style:{position:"relative"},cols:"12"},{default:h(()=>[c(K,{class:"pa-0",title:" الشركات "},{default:h(()=>[c(se)]),_:1}),Q(s).can(["companies.create","admin.super","admin.company"])?(d(),y(ae,{key:0})):W("",!0)]),_:1}))}};export{ie as default};
