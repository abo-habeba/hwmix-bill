import{aS as M,aT as ae,aU as re,aV as R,r as y,h as T,aW as K,aX as j,d as l,F,aY as oe,m as D,aZ as ce,a_ as de,a$ as ve,b0 as fe,b1 as me,b2 as ge,H as q,v as he,b3 as pe,b4 as be,I as z,a9 as P,aC as H,K as Ve,L as Ie,b5 as we,b6 as Ce,a3 as B,b7 as ke,b8 as xe,b9 as ye,ba as k,bb as W,bc as Te,bd as Pe,be as Se,G as X,P as _e,k as Y,j as C,aI as Ae,ap as De,o as Z,b as L,ah as J,M as Le,a as Ge,u as $e,q as Ee,U as Q,t as ee,a1 as Be,a6 as Fe,bf as Ue,au as Me,Y as Re,X as Ke,$ as E,Z as Ne,aH as Oe}from"./index-OBUj7dXK.js";const je=M({...ae(re({collapseIcon:"$treeviewCollapse",expandIcon:"$treeviewExpand"}),["subgroup"])},"VTreeviewGroup"),te=R()({name:"VTreeviewGroup",props:je(),setup(e,V){let{slots:v}=V;const t=y(),r=T(()=>{var m;return(m=t.value)!=null&&m.isOpen?e.collapseIcon:e.expandIcon}),h=T(()=>{var m;return{VTreeviewItem:{prependIcon:void 0,appendIcon:void 0,active:(m=t.value)==null?void 0:m.isOpen,toggleIcon:r.value}}});return K(()=>{const m=j.filterProps(e);return l(j,D(m,{ref:t,class:["v-treeview-group",e.class],subgroup:!0}),{...v,activator:v.activator?o=>l(F,null,[l(oe,{defaults:h.value},{default:()=>{var f;return[(f=v.activator)==null?void 0:f.call(v,o)]}})]):void 0})}),{}}}),ne=Symbol.for("vuetify:v-treeview"),qe=M({loading:Boolean,toggleIcon:ce,...de({slim:!0})},"VTreeviewItem"),le=R()({name:"VTreeviewItem",props:qe(),setup(e,V){let{attrs:v,slots:t,emit:r}=V;const h=ve(e,v),m=T(()=>e.value===void 0?h.href.value:e.value),o=y(),{activate:f,isActivated:p,select:I,isSelected:g,isIndeterminate:w,isGroupActivator:x,root:a,id:i}=fe(m,!1),c=T(()=>a.activatable.value&&x),{densityClasses:d}=me(e,"v-list-item"),s=T(()=>({isActive:p.value,select:I,isSelected:g.value,isIndeterminate:w.value})),n=T(()=>{var b;return!e.disabled&&e.link!==!1&&(e.link||h.isClickable.value||e.value!=null&&!!((b=o.value)!=null&&b.list))});function u(b){var G,$;!n.value||!c.value&&x||a.activatable.value&&(c.value?f(!p.value,b):($=o.value)==null||$.activate(!((G=o.value)!=null&&G.isActivated),b))}function S(b){(b.key==="Enter"||b.key===" ")&&(b.preventDefault(),u(b))}const _=ge(ne,{visibleIds:y()}).visibleIds;return K(()=>{var N;const b=t.title||e.title!=null,G=t.subtitle||e.subtitle!=null,$=q.filterProps(e),ue=t.prepend||e.toggleIcon;return c.value?he(l("div",{class:["v-list-item","v-list-item--one-line","v-treeview-item","v-treeview-item--activetable-group-activator",{"v-list-item--active":p.value||g.value,"v-treeview-item--filtered":_.value&&!_.value.has(i.value)},d.value,e.class],onClick:u},[l(F,null,[be(p.value||g.value,"v-list-item"),e.toggleIcon&&l(z,{start:!1},{default:()=>[l(P,{density:"compact",icon:e.toggleIcon,loading:e.loading,variant:"text",onClick:e.onClick},{loader(){return l(H,{indeterminate:"disable-shrink",size:"20",width:"2"},null)}})]})]),l("div",{class:"v-list-item__content","data-no-activator":""},[b&&l(Ve,{key:"title"},{default:()=>{var A;return[((A=t.title)==null?void 0:A.call(t,{title:e.title}))??e.title]}}),G&&l(Ie,{key:"subtitle"},{default:()=>{var A;return[((A=t.subtitle)==null?void 0:A.call(t,{subtitle:e.subtitle}))??e.subtitle]}}),(N=t.default)==null?void 0:N.call(t,s.value)])]),[[pe("ripple"),n.value&&e.ripple]]):l(q,D({ref:o},$,{class:["v-treeview-item",{"v-treeview-item--filtered":_.value&&!_.value.has(i.value)},e.class],value:i.value,onClick:u,onKeydown:n.value&&S}),{...t,prepend:ue?A=>{var O;return l(F,null,[e.toggleIcon&&l(z,{start:!1},{default:()=>[l(P,{density:"compact",icon:e.toggleIcon,loading:e.loading,variant:"text"},{loader(){return l(H,{indeterminate:"disable-shrink",size:"20",width:"2"},null)}})]}),(O=t.prepend)==null?void 0:O.call(t,A)])}:void 0})}),{}}}),ie=M({loadChildren:Function,loadingIcon:{type:String,default:"$loading"},items:Array,selectable:Boolean,selectStrategy:[String,Function,Object]},"VTreeviewChildren"),U=R()({name:"VTreeviewChildren",props:ie(),setup(e,V){let{emit:v,slots:t}=V;const r=we(null);function h(o){return new Promise(f=>{var p,I;if(!((p=e.items)!=null&&p.length)||!e.loadChildren)return f();if(((I=o==null?void 0:o.children)==null?void 0:I.length)===0){r.value=o.value,e.loadChildren(o).then(f);return}f()}).finally(()=>{r.value=null})}function m(o,f){e.selectable&&o(!f)}return()=>{var o,f;return((o=t.default)==null?void 0:o.call(t))??((f=e.items)==null?void 0:f.map(p=>{var d;let{children:I,props:g,raw:w}=p;const x=r.value===w.value,a={prepend:s=>{var n;return l(F,null,[e.selectable&&(!I||I&&!["leaf","single-leaf"].includes(e.selectStrategy))&&l("div",null,[l(Ce,{key:w.value,modelValue:s.isSelected,loading:x,indeterminate:s.isIndeterminate,onClick:B(()=>m(s.select,s.isSelected),["stop"]),onKeydown:u=>{["Enter","Space"].includes(u.key)&&(u.stopPropagation(),m(s.select,s.isSelected))}},null)]),(n=t.prepend)==null?void 0:n.call(t,{...s,item:w})])},append:t.append?s=>{var n;return(n=t.append)==null?void 0:n.call(t,{...s,item:w})}:void 0,title:t.title?s=>{var n;return(n=t.title)==null?void 0:n.call(t,{...s,item:w})}:void 0},i=te.filterProps(g),c=U.filterProps(e);return I?l(te,D({value:g==null?void 0:g.value},i),{activator:s=>{let{props:n}=s;const u={...g,...n,value:g==null?void 0:g.value};return l(le,D(u,{loading:x,onClick:()=>h(w)}),a)},default:()=>l(U,D(c,{items:I}),t)}):((d=t.item)==null?void 0:d.call(t,{props:g}))??l(le,g,a)}))}}});function se(e){let V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];for(const v of e)V.push(v),v.children&&se(v.children,V);return V}const ze=M({openAll:Boolean,search:String,...ke({filterKeys:["title"]}),...ie(),...ae(xe({collapseIcon:"$treeviewCollapse",expandIcon:"$treeviewExpand",slim:!0}),["nav"])},"VTreeview"),He=R()({name:"VTreeview",props:ze(),emits:{"update:opened":e=>!0,"update:activated":e=>!0,"update:selected":e=>!0,"click:open":e=>!0,"click:select":e=>!0},setup(e,V){let{slots:v}=V;const{items:t}=ye(e),r=k(e,"activeColor"),h=k(e,"baseColor"),m=k(e,"color"),o=W(e,"activated"),f=W(e,"selected"),p=y(),I=T(()=>e.openAll?d(t.value):e.opened),g=T(()=>se(t.value)),w=k(e,"search"),{filteredItems:x}=Te(e,g,w),a=T(()=>w.value?new Set(x.value.flatMap(s=>[...i(s.props.value),...c(s.props.value)])):null);function i(s){var S;const n=[];let u=s;for(;u!=null;)n.unshift(u),u=(S=p.value)==null?void 0:S.parents.get(u);return n}function c(s){var S,_;const n=[],u=(((S=p.value)==null?void 0:S.children.get(s))??[]).slice();for(;u.length;){const b=u.shift();b&&(n.push(b),u.push(...(((_=p.value)==null?void 0:_.children.get(b))??[]).slice()))}return n}function d(s){let n=[];for(const u of s)u.children&&(n.push(u.value),u.children&&(n=n.concat(d(u.children))));return n}return Pe(ne,{visibleIds:a}),Se({VTreeviewGroup:{activeColor:r,baseColor:h,color:m,collapseIcon:k(e,"collapseIcon"),expandIcon:k(e,"expandIcon")},VTreeviewItem:{activeClass:k(e,"activeClass"),activeColor:r,baseColor:h,color:m,density:k(e,"density"),disabled:k(e,"disabled"),lines:k(e,"lines"),variant:k(e,"variant")}}),K(()=>{const s=X.filterProps(e),n=U.filterProps(e);return l(X,D({ref:p},s,{class:["v-treeview",e.class],style:e.style,opened:I.value,activated:o.value,"onUpdate:activated":u=>o.value=u,selected:f.value,"onUpdate:selected":u=>f.value=u}),{default:()=>[l(U,D(n,{items:t.value}),v)]})}),{open}}}),We={style:{width:"max-content"}},Ye={__name:"Categories",setup(e){const V=y([]),v=y([]),t=y(!1),r=y({name:"",description:"",parent_id:null}),h=y(!1);function m(a){h.value=!1,a?r.value.parent_id=a.id:r.value.parent_id=null,r.value.name="",r.value.description="",t.value=!0}function o(a){h.value=!0,r.value={...a},t.value=!0}function f(){t.value=!1,h.value=!1,r.value={name:"",description:"",parent_id:null}}function p(a){const i={};a.forEach(d=>{d.children=d.children||[],i[d.id]=d});const c=[];return a.forEach(d=>{d.parent_id?i[d.parent_id]&&i[d.parent_id].children.push(d):c.push(d)}),c}function I(){De("categories").then(a=>{V.value=a,console.log(V.value),v.value=p(V.value),console.log(v.value)})}const g=a=>({expandIcon:a.children&&a.children.length?"ri-folder-line":"ri-checkbox-blank-circle-line",collapseIcon:a.children&&a.children.length?"ri-folder-open-line":"ri-checkbox-blank-circle-line"});_e(()=>{I()});function w(){if(!r.value.name){E.error("اسم الفئة مطلوب");return}const a=h.value&&r.value.id;Ne("category",r.value,a?r.value.id:!1,!0,!0).then(()=>{I(),f()}).catch(()=>E.error(a?"حدث خطأ أثناء تعديل الفئة":"حدث خطأ أثناء حفظ الفئة"))}function x(a){confirm("هل أنت متأكد من حذف هذه الفئة؟")&&Oe("category",a).then(()=>{I(),E.success("تم حذف الفئة بنجاح")}).catch(()=>E.error("حدث خطأ أثناء حذف الفئة"))}return(a,i)=>(Z(),Y(Ae,null,{default:C(()=>[l(P,{color:"primary",class:"mb-4",onClick:i[0]||(i[0]=c=>m(null))},{default:C(()=>i[4]||(i[4]=[L("اضافة فئة رئيسية جديدة")])),_:1}),l(Q,{class:"mt-4 pa-3",outlined:"",style:{"overflow-x":"auto"}},{default:C(()=>[l(J,null,{default:C(()=>i[5]||(i[5]=[L("الفئات الهرمية")])),_:1}),l(Le),Ge("div",We,[v.value.length?(Z(),Y($e(He),{key:0,items:v.value,"item-title":"name","item-value":"id","open-on-click":"","item-props":g,class:"treeview-border ma-auto","max-width":"unset"},{append:C(({item:c})=>[l(P,{icon:"ri-add-line",variant:"text",color:"primary",onClick:B(d=>m(c),["stop"]),title:"إضافة فرعية",class:"mx-1"},null,8,["onClick"]),l(P,{icon:"ri-edit-line",variant:"text",color:"primary",onClick:B(d=>o(c),["stop"]),title:"تعديل الفئة",class:"mx-1"},null,8,["onClick"]),l(P,{icon:"ri-delete-bin-line",variant:"text",color:"error",onClick:B(d=>x(c.id),["stop"]),title:"حذف الفئة",class:"mx-1"},null,8,["onClick"])]),_:1},8,["items"])):Ee("",!0)])]),_:1}),l(Ke,{modelValue:t.value,"onUpdate:modelValue":i[3]||(i[3]=c=>t.value=c),"max-width":"500px"},{default:C(()=>[l(Q,null,{default:C(()=>[l(J,null,{default:C(()=>[L(ee(h.value?"تعديل فئة":"اضافة فئة جديدة"),1)]),_:1}),l(Be,null,{default:C(()=>[l(Fe,{class:"pa-2",modelValue:r.value.name,"onUpdate:modelValue":i[1]||(i[1]=c=>r.value.name=c),label:"اسم الفئة",required:""},null,8,["modelValue"]),l(Ue,{class:"pa-2",modelValue:r.value.description,"onUpdate:modelValue":i[2]||(i[2]=c=>r.value.description=c),label:"الوصف"},null,8,["modelValue"])]),_:1}),l(Me,null,{default:C(()=>[l(Re),l(P,{text:"",onClick:f},{default:C(()=>i[6]||(i[6]=[L("الغاء")])),_:1}),l(P,{text:"",color:"blue darken-1",onClick:w},{default:C(()=>[L(ee(h.value?"تعديل":"حفظ"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Ye as default};
