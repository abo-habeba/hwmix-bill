import{_ as N,o as d,k as g,a9 as T,z as M,Z as $,r as t,P as q,w as L,ao as R,ap as j,c as O,d as c,a as B,j as h,aq as Z,F as G,a5 as H,U as J,u as K,q as Q}from"./index-CDiS6puo.js";import{_ as W}from"./ContextMenu-CjtTgtpo.js";import{D as X}from"./DeletedItem-C2GyAdW4.js";import{u as Y}from"./appState-DUU1zFHv.js";const ee={};function te(w,s){return d(),g(T,{class:"text-center btn-add",density:"compact",variant:"flat",style:{"background-color":"#28a745 !important",color:"white","z-index":"10"},"prepend-icon":"ri-add-line",to:{name:"edit-company"}})}const ae=N(ee,[["render",te],["__scopeId","data-v-3838b115"]]),ne={id:"dataTable",style:{position:"relative !important","white-space":"nowrap"}},oe=["src"],se={__name:"CompanysDataTable",setup(w){const s=M(),k=$(),x=Y(),m=t(0),r=t([]),i=t(null),C=t(!1),b=t(10),U=t({nickname:"",phone:"",status:"",created_at_from:"",created_at_to:""}),_=t({page:1,sortBy:[],itemsPerPage:10}),V=t([{title:"#",key:"id",align:"center"},{title:"الشعار",key:"imageLogo",align:"center"},{title:"الاسم",key:"name",align:"center"},{title:"رقم الهاتف",key:"phone",align:"center"},{title:"المجال",key:"field",align:"center"},{title:"الوصف",key:"description",align:"center"}]);q(()=>{P()});const D=t(null),S=t(()=>{k.push({name:"edit-company",params:{id:i.value.id}}),p()}),I=t(()=>{D.value=[i.value],x.dialogDelete=!0,p()});t(()=>{p()});const v=t([]),y=t([]),A=a=>{r.value=r.value.filter(e=>!a.includes(e.id)),s.fetchUser()};L(()=>i.value,async a=>{if(!a)return;const e=await s.can(["company_update_self","company_update_own","company_update","super_admin","company_owner"]),n=await s.can(["company_delete_self","company_delete_own","company_delete","super_admin","company_owner"]);y.value=[e?{title:"تعديل",color:"#007bff",icon:"ri-pencil-line",callback:S.value}:null,n?{title:"حذف",color:"#dc3545",icon:"ri-delete-bin-line",callback:I.value}:null].filter(Boolean)},{immediate:!0}),R(()=>{y.value.length===0?v.value=[{title:"لا تملك إجراءات",color:"#6c757d",icon:"ri-spam-3-line",callback:()=>{}}]:v.value=y.value});const l=t(null),z=(a,{item:e})=>{i.value=e,a.preventDefault(),l.value&&l.value.showContextMenu(a)},p=()=>{l.value?l.value.colsContextMenu():console.error("Context menu is not initialized.")};async function P(){const{page:a,itemsPerPage:e,sortBy:n}=_.value,f=n.length?n[0].key:"id",o=n.length&&n[0].order?n[0].order:"desc",F=e===-1?m.value:e;try{const u=await j("companys",{page:a,per_page:F,sort_by:f,sort_order:o,...U.value});r.value=u.data,m.value=u.total}catch(u){console.error("Error fetching company:",u)}finally{C.value=!1}}function E({item:a,index:e}){return{class:e%2!==0?"active-row":"","data-index":e}}return(a,e)=>{const n=X,f=W;return d(),O(G,null,[c(n,{onUpdateItems:A,api:"company/delete",dataDelete:{items:D.value,key:"name"}},null,8,["dataDelete"]),B("div",ne,[c(Z,{"item-value":"id","items-per-page":b.value,"onUpdate:itemsPerPage":e[0]||(e[0]=o=>b.value=o),options:_.value,"onUpdate:options":[e[1]||(e[1]=o=>_.value=o),P],headers:V.value,items:r.value,"items-length":m.value,loading:C.value,hover:"","show-current-page":"","row-props":E,"loading-text":" جاري تحمل البيانات ","no-data-text":" لا توجد بيانات ","items-per-page-text":"عدد الصفوف في الصفحة","onContextmenu:row":z,onClick:p},{"item.imageLogo":h(({item:o})=>[B("img",{class:"mt-2",width:"100",height:"50",src:o.logo,alt:"Avatar"},null,8,oe)]),_:1},8,["items-per-page","options","headers","items","items-length","loading"]),c(f,{ref_key:"contextMenu",ref:l,actions:v.value},null,8,["actions"])])],64)}}},pe={__name:"companys",setup(w){const s=M();return(k,x)=>(d(),g(H,{style:{position:"relative"},cols:"12"},{default:h(()=>[c(J,{class:"pa-0",title:" الشركات "},{default:h(()=>[c(se)]),_:1}),K(s).can(["companys_create","super_admin","company_owner"])?(d(),g(ae,{key:0})):Q("",!0)]),_:1}))}};export{pe as default};
