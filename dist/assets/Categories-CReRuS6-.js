import{aO as R,aP as ne,aQ as oe,aR as O,r as y,j as k,aS as K,aT as j,d as l,F as B,aU as de,aK as D,aV as ce,aW as ve,aX as fe,aY as me,aZ as ge,a_ as pe,I as q,y as Ve,a$ as he,b0 as be,J as z,a2 as _,b1 as Q,L as Ie,M as we,s as Ce,b2 as ke,an as U,b3 as ye,b4 as Te,b5 as xe,g as C,b6 as W,b7 as Pe,b8 as Se,b9 as Ae,H as X,Q as Le,m as Z,n as b,ay as De,ah as Ge,o as H,b as L,aa as J,N as _e,u as $e,V as Y,t as ee,v as Fe,X as te,a1 as Be,al as Ee,aI as Re,aq as Oe,$ as Ue,Z as Ke,aE as G,a0 as Me,aF as Ne}from"./index-CTwtWwMO.js";const je=R({...ne(oe({collapseIcon:"$treeviewCollapse",expandIcon:"$treeviewExpand"}),["subgroup"])},"VTreeviewGroup"),le=O()({name:"VTreeviewGroup",props:je(),setup(e,h){let{slots:c}=h;const t=y(),v=k(()=>{var f;return(f=t.value)!=null&&f.isOpen?e.collapseIcon:e.expandIcon}),w=k(()=>{var f;return{VTreeviewItem:{prependIcon:void 0,appendIcon:void 0,active:(f=t.value)==null?void 0:f.isOpen,toggleIcon:v.value}}});return K(()=>{const f=j.filterProps(e);return l(j,D(f,{ref:t,class:["v-treeview-group",e.class],subgroup:!0}),{...c,activator:c.activator?r=>l(B,null,[l(de,{defaults:w.value},{default:()=>{var m;return[(m=c.activator)==null?void 0:m.call(c,r)]}})]):void 0})}),{}}}),ie=Symbol.for("vuetify:v-treeview"),qe=R({loading:Boolean,toggleIcon:ce,...ve({slim:!0})},"VTreeviewItem"),ae=O()({name:"VTreeviewItem",props:qe(),setup(e,h){let{attrs:c,slots:t,emit:v}=h;const w=fe(e,c),f=k(()=>e.value===void 0?w.href.value:e.value),r=y(),{activate:m,isActivated:p,select:I,isSelected:g,isIndeterminate:n,isGroupActivator:a,root:o,id:d}=me(f,!1),T=k(()=>o.activatable.value&&a),{densityClasses:x}=ge(e,"v-list-item"),s=k(()=>({isActive:p.value,select:I,isSelected:g.value,isIndeterminate:n.value})),i=k(()=>{var V;return!e.disabled&&e.link!==!1&&(e.link||w.isClickable.value||e.value!=null&&!!((V=r.value)!=null&&V.list))});function u(V){var $,F;!i.value||!T.value&&a||o.activatable.value&&(T.value?m(!p.value,V):(F=r.value)==null||F.activate(!(($=r.value)!=null&&$.isActivated),V))}function P(V){(V.key==="Enter"||V.key===" ")&&(V.preventDefault(),u(V))}const S=pe(ie,{visibleIds:y()}).visibleIds;return K(()=>{var M;const V=t.title||e.title!=null,$=t.subtitle||e.subtitle!=null,F=q.filterProps(e),re=t.prepend||e.toggleIcon;return T.value?Ve(l("div",{class:["v-list-item","v-list-item--one-line","v-treeview-item","v-treeview-item--activetable-group-activator",{"v-list-item--active":p.value||g.value,"v-treeview-item--filtered":S.value&&!S.value.has(d.value)},x.value,e.class],onClick:u},[l(B,null,[be(p.value||g.value,"v-list-item"),e.toggleIcon&&l(z,{start:!1},{default:()=>[l(_,{density:"compact",icon:e.toggleIcon,loading:e.loading,variant:"text",onClick:e.onClick},{loader(){return l(Q,{indeterminate:"disable-shrink",size:"20",width:"2"},null)}})]})]),l("div",{class:"v-list-item__content","data-no-activator":""},[V&&l(Ie,{key:"title"},{default:()=>{var A;return[((A=t.title)==null?void 0:A.call(t,{title:e.title}))??e.title]}}),$&&l(we,{key:"subtitle"},{default:()=>{var A;return[((A=t.subtitle)==null?void 0:A.call(t,{subtitle:e.subtitle}))??e.subtitle]}}),(M=t.default)==null?void 0:M.call(t,s.value)])]),[[he("ripple"),i.value&&e.ripple]]):l(q,D({ref:r},F,{class:["v-treeview-item",{"v-treeview-item--filtered":S.value&&!S.value.has(d.value)},e.class],value:d.value,onClick:u,onKeydown:i.value&&P}),{...t,prepend:re?A=>{var N;return l(B,null,[e.toggleIcon&&l(z,{start:!1},{default:()=>[l(_,{density:"compact",icon:e.toggleIcon,loading:e.loading,variant:"text"},{loader(){return l(Q,{indeterminate:"disable-shrink",size:"20",width:"2"},null)}})]}),(N=t.prepend)==null?void 0:N.call(t,A)])}:void 0})}),{}}}),se=R({loadChildren:Function,loadingIcon:{type:String,default:"$loading"},items:Array,selectable:Boolean,selectStrategy:[String,Function,Object]},"VTreeviewChildren"),E=O()({name:"VTreeviewChildren",props:se(),setup(e,h){let{emit:c,slots:t}=h;const v=Ce(null);function w(r){return new Promise(m=>{var p,I;if(!((p=e.items)!=null&&p.length)||!e.loadChildren)return m();if(((I=r==null?void 0:r.children)==null?void 0:I.length)===0){v.value=r.value,e.loadChildren(r).then(m);return}m()}).finally(()=>{v.value=null})}function f(r,m){e.selectable&&r(!m)}return()=>{var r,m;return((r=t.default)==null?void 0:r.call(t))??((m=e.items)==null?void 0:m.map(p=>{var x;let{children:I,props:g,raw:n}=p;const a=v.value===n.value,o={prepend:s=>{var i;return l(B,null,[e.selectable&&(!I||I&&!["leaf","single-leaf"].includes(e.selectStrategy))&&l("div",null,[l(ke,{key:n.value,modelValue:s.isSelected,loading:a,indeterminate:s.isIndeterminate,onClick:U(()=>f(s.select,s.isSelected),["stop"]),onKeydown:u=>{["Enter","Space"].includes(u.key)&&(u.stopPropagation(),f(s.select,s.isSelected))}},null)]),(i=t.prepend)==null?void 0:i.call(t,{...s,item:n})])},append:t.append?s=>{var i;return(i=t.append)==null?void 0:i.call(t,{...s,item:n})}:void 0,title:t.title?s=>{var i;return(i=t.title)==null?void 0:i.call(t,{...s,item:n})}:void 0},d=le.filterProps(g),T=E.filterProps(e);return I?l(le,D({value:g==null?void 0:g.value},d),{activator:s=>{let{props:i}=s;const u={...g,...i,value:g==null?void 0:g.value};return l(ae,D(u,{loading:a,onClick:()=>w(n)}),o)},default:()=>l(E,D(T,{items:I}),t)}):((x=t.item)==null?void 0:x.call(t,{props:g}))??l(ae,g,o)}))}}});function ue(e){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];for(const c of e)h.push(c),c.children&&ue(c.children,h);return h}const ze=R({openAll:Boolean,search:String,...ye({filterKeys:["title"]}),...se(),...ne(Te({collapseIcon:"$treeviewCollapse",expandIcon:"$treeviewExpand",slim:!0}),["nav"])},"VTreeview"),Qe=O()({name:"VTreeview",props:ze(),emits:{"update:opened":e=>!0,"update:activated":e=>!0,"update:selected":e=>!0,"click:open":e=>!0,"click:select":e=>!0},setup(e,h){let{slots:c}=h;const{items:t}=xe(e),v=C(e,"activeColor"),w=C(e,"baseColor"),f=C(e,"color"),r=W(e,"activated"),m=W(e,"selected"),p=y(),I=k(()=>e.openAll?x(t.value):e.opened),g=k(()=>ue(t.value)),n=C(e,"search"),{filteredItems:a}=Pe(e,g,n),o=k(()=>n.value?new Set(a.value.flatMap(s=>[...d(s.props.value),...T(s.props.value)])):null);function d(s){var P;const i=[];let u=s;for(;u!=null;)i.unshift(u),u=(P=p.value)==null?void 0:P.parents.get(u);return i}function T(s){var P,S;const i=[],u=(((P=p.value)==null?void 0:P.children.get(s))??[]).slice();for(;u.length;){const V=u.shift();V&&(i.push(V),u.push(...(((S=p.value)==null?void 0:S.children.get(V))??[]).slice()))}return i}function x(s){let i=[];for(const u of s)u.children&&(i.push(u.value),u.children&&(i=i.concat(x(u.children))));return i}return Se(ie,{visibleIds:o}),Ae({VTreeviewGroup:{activeColor:v,baseColor:w,color:f,collapseIcon:C(e,"collapseIcon"),expandIcon:C(e,"expandIcon")},VTreeviewItem:{activeClass:C(e,"activeClass"),activeColor:v,baseColor:w,color:f,density:C(e,"density"),disabled:C(e,"disabled"),lines:C(e,"lines"),variant:C(e,"variant")}}),K(()=>{const s=X.filterProps(e),i=E.filterProps(e);return l(X,D({ref:p},s,{class:["v-treeview",e.class],style:e.style,opened:I.value,activated:r.value,"onUpdate:activated":u=>r.value=u,selected:m.value,"onUpdate:selected":u=>m.value=u}),{default:()=>[l(E,D(i,{items:t.value}),c)]})}),{open}}}),Xe={__name:"Categories",setup(e){const h=y([]),c=y([]),t=y(!1),v=y({name:"",description:"",parent_id:null});function w(n){const a={};n.forEach(d=>{d.children=d.children||[],a[d.id]=d});const o=[];return n.forEach(d=>{d.parent_id?a[d.parent_id]&&a[d.parent_id].children.push(d):o.push(d)}),o}function f(){Ge("categories").then(n=>{h.value=n.data,console.log(h.value),c.value=w(h.value),console.log(c.value)})}const r=n=>({expandIcon:n.children&&n.children.length?"ri-add-line":"ri-checkbox-blank-circle-line",collapseIcon:n.children&&n.children.length?"ri-subtract-line":"ri-checkbox-blank-circle-line"});Le(()=>{f()});function m(n){n?v.value.parent_id=n.id:v.value.parent_id=null,t.value=!0}function p(){t.value=!1,v.value={name:"",description:"",parent_id:null}}function I(){if(!v.value.name){G.error("اسم الفئة مطلوب");return}Me("category",v.value,!1,!0,!0).then(()=>{f(),p(),G.success("تم حفظ الفئة بنجاح")}).catch(()=>G.error("حدث خطأ أثناء حفظ الفئة"))}function g(n){confirm("هل أنت متأكد من حذف هذه الفئة؟")&&Ne("category",n).then(()=>{f(),G.success("تم حذف الفئة بنجاح")}).catch(()=>G.error("حدث خطأ أثناء حذف الفئة"))}return(n,a)=>(H(),Z(De,null,{default:b(()=>[l(_,{color:"primary",class:"mb-4",onClick:a[0]||(a[0]=o=>m(null))},{default:b(()=>a[4]||(a[4]=[L("اضافة فئة رئيسية جديدة")])),_:1}),l(te,{class:"mt-4 pa-3",outlined:""},{default:b(()=>[l(J,null,{default:b(()=>a[5]||(a[5]=[L("الفئات الهرمية")])),_:1}),l(_e),c.value.length?(H(),Z($e(Qe),{key:0,items:c.value,"item-title":"name","item-value":"id","open-on-click":"","item-props":r,class:"treeview-border ma-auto","max-width":"500px"},{append:b(({item:o})=>[l(Y,{small:"",class:"ma-3",onClick:U(d=>m(o),["stop"])},{default:b(()=>a[6]||(a[6]=[L(ee("ri-add-line"))])),_:2},1032,["onClick"]),l(Y,{class:"ma-3",small:"",color:"red",onClick:U(d=>g(o.id),["stop"])},{default:b(()=>a[7]||(a[7]=[L(ee("ri-delete-bin-6-line"))])),_:2},1032,["onClick"])]),_:1},8,["items"])):Fe("",!0)]),_:1}),l(Ke,{modelValue:t.value,"onUpdate:modelValue":a[3]||(a[3]=o=>t.value=o),"max-width":"500px"},{default:b(()=>[l(te,null,{default:b(()=>[l(J,null,{default:b(()=>a[8]||(a[8]=[L("اضافة فئة جديدة")])),_:1}),l(Be,null,{default:b(()=>[l(Ee,{class:"pa-2",modelValue:v.value.name,"onUpdate:modelValue":a[1]||(a[1]=o=>v.value.name=o),label:"اسم الفئة",required:""},null,8,["modelValue"]),l(Re,{class:"pa-2",modelValue:v.value.description,"onUpdate:modelValue":a[2]||(a[2]=o=>v.value.description=o),label:"الوصف"},null,8,["modelValue"])]),_:1}),l(Oe,null,{default:b(()=>[l(Ue),l(_,{text:"",onClick:p},{default:b(()=>a[9]||(a[9]=[L("الغاء")])),_:1}),l(_,{text:"",color:"blue darken-1",onClick:I},{default:b(()=>a[10]||(a[10]=[L("حفظ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Xe as default};
